function sleep(t){for(var i=(new Date).getTime(),e=0;1e7>e&&!((new Date).getTime()-i>t);e++);}var band=0;doppler.init(function(t){band=t.left-t.right});var MAX_DISTANCE=210,PARTICLES=60,PARTICLE_SIZE=5;Math.Tau=2*Math.PI,Math.rand=function(t,i){return Math.floor(Math.random()*(i-t+1))+t},Math.map=function(t,i,e,n,o){return(t-i)*(o-n)/(e-i)+n},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),window.addEventListener("load",function(t){var i,e,n=document.getElementById("c"),o=n.getContext("2d"),r=0,a=!1,s=new Stats,h=new MousePositionMonitor,d=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;s.setMode(0),s.domElement.style.position="absolute",s.domElement.style.right="5px",s.domElement.style.bottom="5px",document.body.appendChild(s.domElement),o.lineWidth="hairline";var l=function(t){i=n.width=window.innerWidth,e=n.height=window.innerHeight};l(),window.addEventListener("resize",l),n.addEventListener("mouseenter",function(){a=!0}),n.addEventListener("mouseleave",function(){a=!1});var f=function(t,i,e,n){this.r=Math.floor(t),this.g=Math.floor(i),this.b=Math.floor(e),this.a=Math.floor(n||255)};f.prototype.clone=function(){return new f(this.r,this.g,this.b,this.a)},f.prototype.toString=function(){return 255===this.a?"rgb("+this.r+", "+this.g+", "+this.b+")":"rgba("+this.r+", "+this.g+", "+this.b+", "+this.a/255+")"};var m=function(t,i,e,n){this.x=t,this.y=i,this.s=e,this.r=e/2,this.vx=(Math.random()<.5?-1:1)*Math.rand(.5,2),this.vy=(Math.random()<.5?-1:1)*Math.rand(.5,2),this.id=r++,n instanceof f?this.c=n:this.c=new f(255,255,255,255)};m.prototype.distance=function(t){return t instanceof m?Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y)):void 0},m.prototype.step=function(){this.x=this.x+this.vx,this.x<this.r?(this.x=this.r,this.vx*=-1):this.x>i-this.r&&(this.x=i-this.r,this.vx*=-1),this.y=this.y+this.vy,this.y<this.r?(this.y=this.r,this.vy*=-1):this.y>e-this.r&&(this.y=e-this.r,this.vy*=-1)},m.prototype.render=function(){o.fillStyle=this.c.toString(),o.beginPath(),o.arc(this.x,this.y,Math.floor(this.s/2),0,Math.Tau,!1),o.closePath(),o.fill()};for(var u=[],c=0;PARTICLES-1>c;c++)u.push(new m(Math.random()*i,Math.random()*e,PARTICLE_SIZE,new f(255*Math.random(),255*Math.random(),255*Math.random(),255)));var M=new m(Math.random()*i,Math.random()*e,2*PARTICLE_SIZE,new f(0,200,100,255));M.imp=!0,u.push(M);var y=function(){o.fillStyle="rgba(0, 0, 0, 0.3)",o.fillRect(0,0,i,e);for(var t={},n=PARTICLES;n--;){var r=u[n],s=n;if(r.step(),r.imp&&a){var l=h.getMousePosition();r.x=l.x,r.y=l.y}for(r.render();s--;){var f=u[s];if(r!==f&&!t[r.id+"-"+f.id]&&!t[f.id+"-"+r.id]){var m=r.distance(f);if(MAX_DISTANCE>m){if(d){var c=r.c.clone();c.a=Math.floor(Math.map(m,MAX_DISTANCE,0,0,255)),o.strokeStyle=c.toString()}else{var M=o.createLinearGradient(r.x,r.y,f.x,f.y),y=r.c.clone(),v=f.c.clone();y.a=v.a=Math.floor(Math.map(m,MAX_DISTANCE,0,0,255)),M.addColorStop(0,y),M.addColorStop(1,v),o.strokeStyle=M}o.beginPath(),o.moveTo(r.x,r.y),o.lineTo(f.x,f.y),o.closePath(),o.stroke(),t[r.id+"-"+f.id]=t[f.id+"-"+r.id]=!0}}}}},v=function(){requestAnimFrame(v),s.begin(),0!=band?(MAX_DISTANCE=10*band,console.log("foca"+band)):console.log("cero"),y(),s.end()};v()});
